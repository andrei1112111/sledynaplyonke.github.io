<base href="https://s3-us-west-2.amazonaws.com/s.cdpn.io/4273/">
<header>
	<h1>Банька<span>по-черному</span></h1>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Банька по-черному</title>

    <script>

        // ====== Универсальная функция для локальных видео ======
function playVideo(video) {
    const src = video.dataset.src || video.src;
    if (!src) return;
    if (!video.src) video.src = src;

    // обязательно задать mute + inline
    video.muted = true;
    video.playsInline = true;

    video.play().catch(err => {
        console.warn("Autoplay blocked, waiting for user gesture:", err);
    });
}

// ====== Инициализация после загрузки страницы ======
document.addEventListener("DOMContentLoaded", () => {
    const videos = document.querySelectorAll("video.header-video");
    let loadedVideos = 0;
    let vfxInitialized = false;

    // === Подсказка ===
    const hint = document.createElement("div");
    hint.textContent = "Нажмите на экран, если видео не начали проигрываться)";
    Object.assign(hint.style, {
        position: "fixed",
        top: "20px",
        right: "-800px",
        background: "rgba(0, 0, 0, 0.7)",
        color: "#fff",
        padding: "12px 18px",
        borderRadius: "8px",
        fontSize: "15px",
        fontFamily: "sans-serif",
        zIndex: 9999,
        boxShadow: "0 0 10px rgba(0,0,0,0.4)",
        transition: "right 0.8s ease, opacity 0.8s ease",
        opacity: "0.9"
    });
    document.body.appendChild(hint);

    setTimeout(() => {
        hint.style.right = "20px";
    }, 10000);

    const hideHint = () => {
        hint.style.opacity = "0";
        hint.style.right = "-400px";
        setTimeout(() => hint.remove(), 800);
        document.removeEventListener("click", hideHint);
        // запустить все видео при первом клике (если autoplay был заблокирован)
        videos.forEach(v => v.play().catch(()=>{}));
    };
    document.addEventListener("click", hideHint);

    // === Функция инициализации VFX ===
    function tryInitVFX() {
        if (vfxInitialized) return;
        if (videos.length === 0 || loadedVideos === videos.length) {
            setTimeout(() => {
                initVFX();
                vfxInitialized = true;
            }, 300);
        }
    }

    // === Запуск загрузки и управление воспроизведением ===
    if (videos.length === 0) {
        tryInitVFX();
    } else {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const video = entry.target;
                if (!video.src && video.dataset.src) {
                    video.src = video.dataset.src; // ленивое подключение
                }

                if (entry.isIntersecting) {
                    // когда видео в зоне видимости — запустить
                    video.play().catch(() => {});
                } else {
                    // если ушло за экран — поставить на паузу
                    video.pause();
                }
            });
        }, {
            threshold: 0.05 // видео считается "на экране", если видно хотя бы 5%
        });

        videos.forEach(video => {
            // Подключаем observer
            observer.observe(video);

            // Начальная инициализация
            playVideo(video);

            // Обработка загрузки
            video.addEventListener("loadeddata", () => {
                loadedVideos++;
                tryInitVFX();
            });

            // Ошибка загрузки
            video.addEventListener("error", () => {
                console.error("Video failed to load:", video.dataset.src || video.src);
                loadedVideos++;
                tryInitVFX();
            });
        });
    }
});

// ====== Инициализация VFX ======
function initVFX() {
    const vfx = new VFX({
        scrollPadding: false,
        postEffect: { shader },
        autoResize: true,
        cover: true,
        mipmap: false, // отключаем генерацию mipmap
    });

    let i = 0;
    for (const el of document.querySelectorAll("img, video, h1, h2, p")) {
        const z = el.getAttribute("data-z");
        const isVideo = el.tagName === "VIDEO";

        vfx.add(el, {
            shader: shader2,
            uniforms: { id: i++ },
            zIndex: z ? parseInt(z) : 0,
            replace: !isVideo
        });
    }

    return vfx;
}


    </script>


    <style>
        video.header-video {
            display: block;
            object-fit: cover;
            pointer-events: none;
            user-select: none;
            background: black;
        }

* {
  box-sizing: border-box;
}
img {
  max-width: 100%; /* Макс. ширина 100% от контейнера */
  height: auto
}

#panorama {
            width: 600px;
            height: 400px;
        }

body {
  margin: 0;
  color: darkslategrey;
}
header { 
	background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/1.jpg) no-repeat;
	padding-top: 61.93333333%;
	background-size: cover;
  font-family: 'Sucrose Bold Two';
}


header img {
	position: absolute;
	top: 0;
	right: 0;
	width: 45.8%;
}
header h1 { 
	position: fixed;
	top: 2rem;
	right: 2rem;
  font-size: 12vw;
  line-height: .8;
  margin-top: 0;
  text-align: center;
  color:beige;
}
header h1 span {
  display: block;
  font-size: 8.75vw;
}
p {
    font-family: 'Courier New', Courier, monospace;
    font:bold;
    color:beige;
    padding: 2rem 15%;
}
main { 
  background: darkslategrey;
  position: relative;
  border: 1px solid darkslategrey;
  font-family: 'IM Fell French Canon Pro';
  font-size: 1.4rem;
  /* padding: 2rem 25%; */
  line-height: 1.6;
}
@media all and (max-width: 400px) {
  main { padding: 2rem; }
}

.video-wrap {
  width: 100%;
  max-width: 900px;   /* ← один размер для всех */
  height: 500px;      /* ← один размер для всех */
  margin: 3rem auto;  /* центр по горизонтали */
  display: flex;
  align-items: center;
  justify-content: center;
  background: black;  /* красиво + letterbox */
}

.video-wrap video {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  display: block;
}


    </style>
</header>
<main>
  <p>Посреди обского моря находится прикрасный остров Таньвань.<br><br>
    Вот только вспомнили мы про него уже в середине февраля... Было принято решение незамедлительно выдвигаться на остров пока лед на море еще прочный.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/2.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/2.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>Собрав сумки мы выдвинулись пасмурным субботним днем. <br>Путь проходил через станцию обское море. По какой-то таинственной причине через эту станцию проходят все пути...</p>          
  <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/3.jpg) no-repeat;
            padding-top: 61.93333333%;
            background-size: cover;
            font-family: 'Sucrose Bold Two';"></h1>

    <p>Зимой станция выглядит грустненько, но есть в этом какой-то думерский вайбик</p> 

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/4.jpg) no-repeat;
            padding-top: 61.93333333%;
            background-size: cover;
            font-family: 'Sucrose Bold Two';"></h1>

    <p>Далее мы начали спуск к обскому морю - водохронилищу появившемуся после строительства Обь ГЭС. Водохранилеще похоронило старый город Бердск и часть Бердского тракта. Городу пришлось переехать на холм повыше а тракт перенесли на пару километров всторону.</p> 

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/5.jpg) no-repeat;
            padding-top: 61.93333333%;
            background-size: cover;
            font-family: 'Sucrose Bold Two';"></h1>

    <p>В настроющий момент ни о тракте ни о старом городе уже ничего не напоминает. Осталось только пара-тройка островов посреди моря. Когда-то это были холмы в полях, сейчас - медленно уходящие под воду островки.</p> 

    <p>На сам остров мы посмотрим когда доберемся до него, а сейчас - лодочная станция на берегу обского моря.</p> 

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/6.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>
    
    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/7.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>Путь к острову проходит по дорожкам протоптанным рыбаками по которым они передвигаются между своими любимыми лунками и рыбными местами.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/8.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/8.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>По пути нам встречались проталины, хотя на улице и было -10 но вода в них не замерзала...</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/9.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>По пути к острову встречаются интересные природные явления. Некоторые рукотворные, некоторые чисто природные.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/10.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>
    
    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/11.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>


    <p>Спустя полтора часа мы все-же добрались до острова. Первая локация которую мы исследовали - Банька.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/12.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>И пусть выглядит она не как лакшери виладж, после двух часов на ногах при холодной погоде начинаешь воспринимать такие места так-же тепло как родной дом.</p>

    <p>И пусть выглядит она не как лакшери виладж, после двух часов на ногах при холодной погоде начинаешь воспринимать такие места так-же тепло как родной дом.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/13.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/13.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>В таких местах встречаются тетради с корандашами. Этакиt дневники возведенной кем-то постройки. На страницах очерки десятков путников посетивших место.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/14.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>Для разведения огня нам предстояло добыть дерева и найти сухих веток для росжига.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/15.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>Следующий этап - разведение огня. Вся древесина была мокрой и плотной, горела только кора.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/16.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/16.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>Процесс занял примерно 40 минут и 3 попытки.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/17.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/17.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>Что может быть вкуснее чая приготовленного на костре?</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/18.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>Поговорим о том почему баня была по-черному.</p>
    <p> У самодельной буржуйки была дырявая крышка и днище вообще без дырок. Тяга создавалась через открытую дверцу, а половина дыма просацивалась прямо в помещение сквозь дырявый дымоход. Дышать можно было только сидя на нижней лавочке, все что выше - было затянуто плотным едким дымом. </p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/19.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/19.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>Несмотря на все трудности, находиться в бане прогретой до +-0 градусов и пить горячий чай было гораздо приятней чем мерзнуть на улице.</p>

    <br>

    <p>И так. Следующая точка на нашем маршруте - так называемая юрта.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/20.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>


    <p>Бросив вещи в юрте, мы начали искать сухи ветки пока на улице не стало совсем темно, а смеркалось уже очень быстро.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/22.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/22.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>После тяжелого дня печь засыпанная пеплом уже не вызывала негативных эмоций. Первым делом мы отчистили дырявое днище.</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/23.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>Занимаясь разведением огня и подготовкой дерева мы не заметили как на улице настпила ночь.</p>
    <p>Буржуйка освещала и обогревала юрту.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/24.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/24.mp4"
        type="video/mp4">
    </video>
    </div>
    <p>Приятный запах еды разносился огнем по округе и в нашу юрту даже наведались несколько путников.</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/25.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/25.mp4"
        type="video/mp4">
    </video>
    </div>
    
    <p>....</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/26.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/26.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>Что может быть вкуснее чая на костре? Конечно же макароны с тушонкой приготовленные в буржуйке!</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/27.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/27.mp4"
        type="video/mp4">
    </video>
    </div>
    

    <p>Как следует отогревшись в юрте мы стали выдвигаться домой.</p>

        <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/28.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/28.mp4"
        type="video/mp4">
    </video>
    </div>

    <p>...</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/29.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/29.mp4"
        type="video/mp4">
    </video>
    </div>


    <p>...</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/30.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>...</p>

    <h1 style="background: url(https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/31.jpg) no-repeat;
                padding-top: 61.93333333%;
                background-size: cover;
                font-family: 'Sucrose Bold Two';"></h1>

    <p>...</p>

    <div class="video-wrap">
    <video
        class="header-video"
        autoplay muted loop playsinline preload="none" disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback noplaybackrate">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/32.webm"
        type="video/webm">
        <source
        src="https://cdn.jsdelivr.net/gh/andrei1112111/sledynaplyonke.github.io@main/data/tanvan/32.mp4"
        type="video/mp4">
    </video>
    </div>


            </main>
<body>
</body>


<!-- ffmpeg -i 32.mp4 -c:v libvpx-vp9 -crf 36 -b:v 0 -vf "scale=960:-2,fps=30" -an 32.webm -->
<!-- ffmpeg -i 32.mp4 -c copy -movflags +faststart 3200.mp4 -->
